## МЕТОДИКА ОБРАБОТКИ изображений и метаданных ##

Многолетняя возня со внушительными наборами изображений, вылившаяся в создание ряда [torrent релизов](https://github.com/aperveyev/booru_processor/blob/master/%23DATA/readme.md) позволила заточить методики и в результате дозреть до данного проекта. Далее описаны основные этапы и приемы, обеспечивающие приемлемое качество релизов при разумных трудозатратах. В качестве ресурса используются два домашних ПК среднего уровня (по 4 ядра, по 8 GB RAM) под Win64 с дисковыми системами, позволяющими хранить все предыдущие torrent-ы (они же backup), текущие данные (дважды), а также все-все "иконки" и базу (Oracle 18 XE) с метаданными (суммарно ~20 TB HDD и 2.5 TB SSD). 

### Скачивание и накопление оригинальных изображений ###

... для очередного *релиза*. На этом этапе обработка данных минимальна.

- файловая структура - по источникам
- причесывание имен (экзотические символы, jpeg -> jpg)
- основные технические фильтры (MPixels)
- файловая дедубликация (на точные повторы) в т.ч. "нахлесты" с предыдущим релизом 
- форматные преобразования (PNG->JPG) и фильтры (de-ANI)

Подробнее опишу чуток позже.

### Начальная обработка и итеративное улучшение *релиза* ###

... в т.ч. с помощью анализа атипичных метаданных. На этом этапе накопление волевым методом прекращается (можно продолжать для следующего релиза, не смешивая его с текущим).

**Начальная итерация:**
- перестройка файловой структура - разбивка по соотношениям сторон, затем по источникам
- отсев/коррекция непропорциональных, коррекция XXL
- дедубликация по подобию (в пределах релиза "выживает лучший", с предыдущим релизом "приоритет предка")
- первичный расчет EXIF- и IM-метаданных (попутно образуются иконки)
- верификация корректности и уникальности ключа BOORU+FID в том числе с предыдущими релизами

**Следующие итерации:**
- отбор кандидатов на ручную обработку/удаление по метаданным
- собственно ручная обработка/удаление на выборке
- миграция изображений с изменившимися пропорциями в соответствующие папки
- актуализация метаданных EXIF (полная) и IM (только для изменений)


**Финальная итерация:**
- полная верификация "глазами" и необходимые обработки/удаления
- расчет FACE-метаданных
- слияние EXIF + IM + FACE-метаданных, расчет TAG-метаданных

### Слияние *текущего релиза* с *пулом предыдущих релизов* ###

Ту би дан.
