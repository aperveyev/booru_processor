Предварительная очистка входного набора - методы, средства и результаты.

source_dir - папка с папками 0000-0999 в которых находятся изображения
target_dir_N - папка где будут храниться изображения, отброшенные шагом очистки N (без внутренней структуры)

1) Малоинформативные файлы и артефакты компрессии

Компрессия JPG и значительное уменьшение размера изображения (512 по длинной стороне) могли привести к потере 
практически всей информации в изображении (очень вытянутое, скетч из тонких линий) индикатором чего является малый размер JPG.
Также - предположительно из за артефактов компрессии - изредка встречаются аномально большие JPG (визуально нормальные).
Опытным путем установлено что можно считать аномальными (порядка 0.1% от количества) файлы до 12000 байт и свыше 50000 байт.

BAT>> for /r source_dir %%F in (*) do @if %%~zF leq 12000 move "%%F" target_dir_1SMALL
BAT>> for /r source_dir %%F in (*) do @if %%~zF geq 500000 move "%%F" target_dir_1BIG

2) Точные файловые дубликаты.

Как ни странно, входной набор не очищен от точных дублей.

Easy Duplicate>> move to target_dir_2FILEDUPS

3) Диспропорциональные или маленькие файлы согласно информации об исходном размере - это еще надо перепроверить !
поэтому сначала надо выполнить перенос файлов по списку имен с сохранением структуры папок чтобы легко было вернуть взад

SQL>>txt
select id --, image_width, image_height, file_ext, file_size -- 12.119
from BOORU_DANB18 t 
where flags='F' and ( image_width<256 or image_height<256 or image_width*image_height < 512*256 )
order by mod(id,1000), id
SQL>>txt
select id --, image_width, image_height, file_ext, file_size -- 11.953
from BOORU_DANB18 t 
where flags='F' and image_height>0 and image_width>0 and ( image_width/image_height > 4 or image_height/image_width > 4 )
order by mod(id,1000), id

BAT>>
for /d %%d in (*) do (
cd %%d
FOR /F "USEBACKQ TOKENS=*" %%F IN ("..\_move_lst_dir.lst") DO (
md e:\target_dir_lst\%%d
MOVE "%%~F" e:\target_dir_lst\%%d\
)
cd ..
)

4) Крайне близкие подобия или дубликаты изображений 

AntiDupl.NET>> similarity <= 0.04%

Для дальнейшего анализа выполнена обрезка фона (как внесенного при создании датасета, так и присущего изображению)

ImageMagick>>

5) Диспропорциональные или маленькие файлы согласно информации об уменьшенном изображении с обрезанным фоном
